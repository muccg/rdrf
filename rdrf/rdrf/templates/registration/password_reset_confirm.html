{% extends "rdrf_cdes/base.html" %}
{% load i18n %}

{% block extrahead %}
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.1/jquery.validate.min.js"></script>

    <script>
        $(document).ready(function() {
            $.validator.addMethod(
                "passwordStrenght",
                function(value, element) {
                    return value.match(/(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{8,})/);
                },
                "The password must be at least 8 characters long and consist of uppercase and lowercase letters, numbers and special characters"
            );
        
            $('#new-password-form')
                .validate({
                    rules : {
                        new_password1 : {
                            passwordStrenght : true,
                        }
                    }
                });
        });
    </script>
{% endblock %}

{% block content %}
<br>

{% if validlink %}
    <div class="row">
        <div class="col-md-6 col-md-offset-3">
            <div class="alert alert-info">
                {% trans "Please enter your new password twice so we can verify you typed it in correctly." %}
            </div>
            <form action="" method="post" class="form" id="new-password-form">
                {% csrf_token %}
                <div class="form-group">
                    <input id="id_new_password1" name="new_password1" type="password" placeholder="New Password" class="form-control" />
                </div>
                <div class="form-group">
                    <input id="id_new_password2" name="new_password2" type="password" placeholder="Confirm password" class="form-control" />
                </div>
                <div class="form-group">
                    <input type="submit" value="{% trans 'Change my password' %}" class="btn btn-success" />
                </div>
            </form>
        </div>
    </div>
{% else %}
    <div class="alert alert-danger">
        {% trans "The password reset link was invalid, possibly because it has already been used.  Please request a new password reset." %}
    </div>
{% endif %}

{% endblock %}
